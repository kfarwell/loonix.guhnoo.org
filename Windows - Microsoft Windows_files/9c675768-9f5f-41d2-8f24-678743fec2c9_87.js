if(typeof Wol==="undefined")Wol={};if(typeof Wol.CP==="undefined")Wol.CP={};(Wol.CP.ContentRotator=function(){"use strict";var rb=0,lc=200,L="criContainer",fb="crcIndicatorRegion",kc="<div class='"+L+"' role='list' aria-live='polite'></div>",hc="<div class='"+fb+"'></div>",ub="aria-label",i="aria-posinset",U="aria-expanded",Q="crcIndicator",uc="<a id='' "+U+"='false' class='"+Q+"' href='#'></a>",x="crcIndicatorDark",K="crcIndicatorLight",ac="<img class='"+x+"' src='http://res1.windows.microsoft.com/resbox/en/windows/main/241b70dd-0302-4d0d-a079-eb109b4ac464_9999.png' alt='' />",Yb="<img class='"+K+"' src='http://res1.windows.microsoft.com/resbox/en/windows/main/4f6e669d-3bc1-41fd-9080-f9bb7c3139e1_9999.png' alt='' />",n=400,p="fade",C="none",A="slide",gc=p,dc=6e3,fc=x,yb="00000",R="left",mc="right",O=R,xc="30px",kb="contentRotatorCollection",sb="crcType",ib="crcInterval",B="crcIndicatorType",zb="crcInstanceId",Ob="crcIndicatorRegionEnabled",Lb="criDescription",tb="VSContainerSelected",jc="AutoStartImmediate",qc="lastElement",Sb="mpControlBarVisible",tc="regionHero",T="hero-base",nc="heroVideoCard",mb="img.embedObject",b="div.",Cb=b+"criCenterVertical",j=b+L,c=b+"contentRotatorItem",u=b+fb,f=b+kb,m=".VideoContainer",I="video",Ub=I+".clvVideo",bc=".mpPoster img",Kb=".mpControlBar",Nb=".mpControlBarNear",ab=".mpControlBarFill",Pb=".mpControlBarFar",Db=".mpTimeline",Y=m+", a, .btnBase",Eb=Y+", "+j,Qb="div#hdr",J="td.hero-far-cell",o=".hero-dock-elm",Zb=b+"hero-stack",s=".hero-bottom-stk-cell",Vb="td.hero-near-cell",Fb="td.hero-min-height-cell",Rb=".hero-container",m=b+"mpContainer",Gb=".para",Ab=1e3,wc=320,E="screen and (min-width: 47.5em)",ob=null,v="data-rotation-inprogress",h="data-rotation-enabled",G="data-initial-content-loaded",H="data-instance-id",X="data-transition-type",t="data-indicator-enabled",eb="data-indicator-active",cb="data-indicator-inactive",wb="data-label",vb="data-card-index",d="true",g="false",V="0",F="1",a="undefined",Ib=new RegExp(/^[a-zA-Z0-9]+?$/),gb={},vc=10,P="ContentRotator",l="z-index",y="height",db="padding-top",k="margin-top",M="opacity",Mb=new RegExp(/iphone|ipod/i),W=a;if(typeof Wol.CP.Common!==a)W=Wol.CP.Common;var e=a;if(typeof W.BI!==a)e=W.BI;$(document).ready(function(){O=pc();$(f).each(function(){yc($(this))})});var Wb=function(a){$(a).find(f).each(function(){$(this).attr(h,g)})},yc=function(i){Tb(i);i.attr("tabindex",0);if(typeof Wol.Util!==a&&typeof Wol.Util.Visibility!==a){Wol.Util.Visibility.initShowListener(i,r);Wol.Util.Visibility.initHideListener(i,Wb)}var f=i;f.height("auto");f.find("."+B).length>0&&f.attr(t,d);var n=D(f,sb),s=D(f,ib),l=D(f,B),p=Xb(l),o=D(f,zb),x="content-region-"+o,j=f.find(c);f.attr(h,d);f.attr(v,g);f.attr(X,n);f.attr(G,g);f.attr(H,o);var k=$(kc);k.attr("id",x);k.insertBefore(j[0]);k.keydown(function(b){b!==null&&typeof b!==a&&b.keyCode===13&&$(this).click()});if(w(f)===true){f.attr(eb,p);f.attr(cb,l);var q=$(hc);q.insertBefore(j[0])}var y=hb(f);j.each(function(){var a=$(this).find(b+Lb+" > p").detach().text();$(this).attr(wb,a);w(f)===true&&oc($(this),f.find(u),l,a,k.id,y);$(this).find(m).each(function(){$(this).find(I).each(function(){$(this).on("play",function(){$(this).parent().find(Kb).addClass(Sb);navigator.userAgent.match(Mb)&&k.parent().attr(h,g);var c=$(this).parent().find(Nb),b=$(this).parent().find(ab),a=$(this).parent().find(Pb);if(c.length===1&&b.length===1&&a.length===1){var i=parseInt(b.css("margin-left"))+parseInt(b.css("margin-right")),f=parseInt(a.css("padding-left"))+parseInt(a.css("padding-right")),d=c.outerWidth()+i,e=a.position().left-f;$(this).parent().find(ab).width(e-d);$(this).parent().find(Db).show()}})})})});$(window).load(function(){typeof e!==a&&e.LogComponentInteraction(this,P,o,"Main","Load",1,e.LoggingType.Custom)});jb(i);$(window).load(function(){cc(i);bb(i);N(i);S(f,j,n);var a=window.setInterval(function(){if(f.attr(h)===d)S(f,j,n);else window.clearInterval(a)},s)});f.focusin(Z);f.find(Y).focusin(Z);f.find(Eb).click(Hb)},Xb=function(a){if(a===x)return K;else return x},Tb=function(a){var b=1,d=a.find(c).length;a.find(c).each(function(){$(this).attr("role","listitem");$(this).attr("aria-setsize",d);$(this).attr(i,b);b++})},w=function(c){var d=c.attr(t);if(typeof d!==a&&d!=="")return true;else if(c.find(b+B).detach().length>0){c.attr(t,"enabled");return true}else return false},oc=function(g,b,e,d,c,f){var a=$(uc);a.attr(vb,g.attr(i));a.attr("aria-controls",c);a.css(l,f);a.attr(ub,d);a.append(ac,Yb);a.addClass(e);b.append(a)},Z=function(){var a=null;if($(this).hasClass(kb))a=$(this);else a=$(this).parents(f).first();a.attr(h,g)},Hb=function(k){var b=$(this).parents(f).first();if(b.attr(v)===d){k.preventDefault();return false}if($(this).hasClass(Q)){var j="";if($(this).attr(U)===d){k.preventDefault();j="ActiveClick"}else{j="InactiveClick";var m=b.find(c);S(b,m,b.attr(X),$(this).attr(vb))}b.attr(h,g);typeof e!==a&&e.LogComponentInteraction(this,P,$(this).parents(f).attr(H),"Indicator",j,$(this).attr(i),e.LoggingType.Click);return false}!$(this).hasClass(tb)&&!$(this).parent().hasClass(tb)&&k.stopPropagation();if($(this).hasClass(L)||!(this.outerHTML.indexOf("void")>-1)){if(b.attr(h)===d)var l="Click";else var l="ClickStop";(!w($(this).parents(f))||window.matchMedia(E).matches===false)&&$(this).parents(f).attr(h,g);typeof e!==a&&e.LogComponentInteraction(this,P,$(this).parents(f).attr(H),"ContentRegion",l,1,e.LoggingType.Click);return true}},jb=function(b){var d=nb(b),a=0;b.find(c).each(function(){d>0&&$(this).width(d);if($(this).height()>a)a=$(this).height()});b.find(j).height(a);b.find(c).each(function(){$(this).height("auto")});b.height(a);return a},bb=function(d){var f=jb(d);if(d.parents(b+nc).length>0||d.parents(b+tc).length>0){var e=d.find(j).find(c).attr(i);if(typeof e!==a){var g=$(d.find(c)[e]).children(b+T);d.find(j).each(function(){rc($(this),g)})}}d.find(c+" "+Cb).each(function(){$(this).css(db,"");var a=(f-$(this).parent().height())/2;$(this).css(db,a+"px")})},rc=function(c,v){var e=c.find(Rb),m=e.data("min-height-phone"),f=e.data("min-height-desktop");if(typeof m!==a&&typeof f!==a){var p=(f-m)/(Ab-wc),u=f-p*Ab,d=p*$(window).width()+u;d=Math.max(Math.min(d,f),m);var q=c.find(J),w=c.find(Vb),s=c.find(Fb);q.length>0&&q.css(y,d);if(typeof d==="number"){s.css(y,d+"px");w.css(k,d+"px")}if(typeof e.attr("data-background-set")!==a){for(var t=window.matchMedia("only all").matches,r=window.matchMedia(E).matches,i="",j="",l=JSON.parse(e.attr("data-background-set")),h=0;h<l.length;h++){var n=l[h].breakpoint,g=l[h].url;if(typeof n!==a&&n!==""&&typeof g!==a&&g!=="")switch(n){case "desktop":i=g;break;case "mini-tablet":j=g}}if(!t||r){c.find(b+T).css("background-color","");c.css(y,d+"px");i!==""&&e.css("background-image","url('"+i+"')")}else{var o=v.css("background-color");typeof o==="string"&&c.find(b+T).css("background-color",o);c.css(y,"auto");j!==""&&e.css("background-image","url('"+j+"')")}e.css("background-size","auto "+d+"px")}}};$(window).on("deviceorientation",function(){if(window.orientation!==ob){r();ob=window.orientation}});$(window).resize(function(){r();window.clearTimeout(rb);rb=window.setTimeout(r,lc)});var r=function(){$(f).each(function(){bb($(this));N($(this));pb($(this))})},pb=function(a){a.attr(t)===d&&a.find(u).css(l,hb(a.find(j)))},S=function(b,l,a,e){b.attr(v,d);var h=false;if(Number(e)!=="NaN"&&e>=1&&e<=l.length)h=true;var f=b.find(j);if(h===true)var k=b.find(c+"["+i+"='"+e+"']");else var k=Jb(b,f);var g=b.attr(G);if((a===A||a===C)&&window.matchMedia(E).matches)xb(f,a,g,true);else{a=p;xb(f,a,g,true)}ic(f,a,k,g,h,e)},q=function(c,g,f){var b=$(c.find(u+" a."+Q)[g]);if(typeof b!==a){var e=c.attr(eb),d=c.attr(cb);if(f===true)b.removeClass(d).addClass(e);else b.removeClass(e).addClass(d);b.attr(U,f)}},xb=function(a,b,f,e){if(b===A){a.css(M,V);a.css(O,xc)}else b===C&&a.css(M,V);if(f===d){q(a.parent(),a.find(c).attr(i)-1,false);e===true&&lb(a.parent(),a)}},ic=function(a,b,c,h,f,j){if(b!==p){Bb(a,c);qb(a.find(J).find(mb))}if(h===g){q(a.parent(),0,true);a.parent().attr(G,d);ec(a.parent())}else if(f===true)q(a.parent(),j-1,true);else{var e=c.attr(i)-1;if(b===p)window.setTimeout(function(){q(a.parent(),e,true)},n);else q(a.parent(),e,true)}if(b===p)a.animate({opacity:V},n,function(){lb(a.parent(),a);Bb(a,c);qb(a.find(J).find(mb));a.animate({opacity:F},n,function(){z(a)})});else if(b===A)if(O===R)a.animate({left:"0px",opacity:F},n,function(){z(a)});else a.animate({right:"0px",opacity:F},n,function(){z(a)});else if(b===C){a.css(M,F);z(a)}a.parent().attr(ub,c.attr(wb))},Bb=function(b,a){b.append(a);sc(a.find(m))},ec=function(a){w(a)&&a.find(u).addClass(Ob)},Jb=function(d,b){var a=0;if(b.html()!=="")a=1;return $(d.find(c)[a]).detach()},lb=function(b,a){a.html()!==""&&a.parent().append(a.contents().detach())},sc=function(b){var a=b.find(bc);a.css(k,a.height()/2*-1);a.css("margin-left",a.width()/2*-1)},qb=function(b){if(typeof(b!==a)){b.attr("style","");b.css("top","0px")}},N=function(a){a.parents(o).css("width","100%");var e=a.parents(o).outerHeight()-a.parents(o).height(),b=a.parents(Zb);if($(b).length>0)if(window.matchMedia(E).matches===true)b.find(s).children(o).css(k,"0px");else{var c=b.find(s).css(k),c=b.find(s).css(k);if(c!=="0px"&&c!==""){var d=a.height()-parseInt(c);d>0&&b.find(s).children(o).css(k,d+e+"px")}}},cc=function(a){a.find(c).each(function(){$(this).find(Gb).last().addClass(qc)})},pc=function(){var b=$(document).find("body").css("direction");if(typeof b!==a&&b.toLowerCase()==="rtl")return mc;else return R},D=function(e,d){var c=e.find(b+d).remove().children("pre").text();c=c.toLowerCase();switch(d){case ib:if(!isNaN(c)&&c>0)return c*1e3;else return dc;break;case sb:if(c===A||c===C)return c;else return gc;break;case B:if(c==="light")return K;else return fc;break;case zb:if(Ib.test(c)===true)if(typeof gb[c]===a){gb[c]=null;return c}else return yb;else return yb}},nb=function(d){var b=d.parent();if(typeof b===a)return 0;var c=b.width();if(typeof c===a||c<1)return nb(b);return c},hb=function(d){var b=0,c=$(Qb).css(l);if(typeof c!==a&&c!=="auto")b=--c;else{d.find("[style]").each(function(){if(isNaN(parseInt($(this).css(l)))===false&&$(this).css(l)>b)b=$(this).css(l)});b+=vc}return b},z=function(a){N(a.parent());pb(a.parent());a.parent().attr(v,g);if(a.parents(":hidden").length===0){a.find(Ub).each(function(){this.autoplay===true&&this.loop===true&&this.paused===true&&this.play()});a.find(m).each(function(){$(this).find(I).each(function(){if($(this).parents(m).hasClass(jc)===true)this.loop===true&&this.paused===true&&this.play()})})}}})()